<!DOCTYPE html>
<html lang="en">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <title>causti • co — How does this website work</title>
    <link rel="stylesheet" href="/assets/styles/main.css" />
    <link rel="icon" href="/assets/icons/favicon.png" sizes="48x48" />
    <link rel="icon" href="/assets/icons/favicon.svg" sizes="any" />
    <link rel="canonical" href="https://causti.co/text/005-website-stack/" />
    <link rel="alternate" href="https://causti.co/feed.xml" type="application/atom+xml" title="causti • co — How does this website work — atom feed" />
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    <meta name="author" content="Martín Valdés de León" />
    <meta name="generator" content="Eleventy v2.0.1" />
    <meta name="description" content="it&#39;s the personal website bottle episode! but i&#39;ll try to keep it interesting. maybe you learn something. maybe you get inspired. we need more personal websites." />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
    <meta property="og:site_name" content="causti • co" />
    <meta property="og:title" content="How does this website work" />
    <meta property="og:description" content="it&#39;s the personal website bottle episode! but i&#39;ll try to keep it interesting. maybe you learn something. maybe you get inspired. we need more personal websites." />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://causti.co/text/005-website-stack/" />
    <meta property="og:image" content="https://causti.co/assets/photo/014-silence-4272w.webp" />
    <meta property="og:image:type" content="image/webp" />
    <meta property="og:image:width" content="4272" />
    <meta property="og:image:height" content="2403" />
    <meta property="og:image:alt" content="A single microwave antena sits atop a modern building." />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@mvaldesdeleon" />
    <meta name="twitter:creator" content="@mvaldesdeleon" />
    <meta name="article:published_time" content="2024-04-19T00:00:00.000Z" />
    <meta name="article:author" content="Martín Valdés de León" />
    <meta name="article:tag" content="development" />
    <meta name="article:tag" content="web" />
    <meta name="article:tag" content="devops" />
  </head>
  <body>
    <header>
      <h1><a href="/" tabindex="-1">causti </a><a href="#egg" tabindex="-1"><img class="dot" src="/assets/images/causti.co.svg" alt="·" width="640" height="640" /></a><a href="/" tabindex="-1"> co</a></h1>
      <div class="actions">
        <a class="feed" href="https://causti.co/feed.xml" tabindex="-1">
          <img src="/assets/images/feed.svg" alt="atom feed" width="256" height="256"  />
        </a>
      </div>
      <div id="egg">
        <div class="palette">
          <ul>
            <li class="white"></li>
            <li class="gray-05"></li>
            <li class="gray-10"></li>
            <li class="gray-15"></li>
            <li class="gray-20"></li>
            <li class="gray-25"></li>
            <li class="gray-30"></li>
            <li class="accent-light"></li>
            <li class="accent-secondary"></li>
            <li class="break"></li>
            <li class="gray-40"></li>
            <li class="gray-50"></li>
            <li class="gray-60"></li>
            <li class="gray-70"></li>
            <li class="gray-80"></li>
            <li class="gray-90"></li>
            <li class="black"></li>
            <li class="accent-dark"></li>
            <li class="void"></li>
          </ul>
        </div>
      </div>
    </header>
    <main>
      <article class="text">
        <h1><span class="offset">te</span><span>xt</span></h1>
        <h2>
          <span class="offset">19.04.24</span>
          <span>#005</span>
        </h2>
        <section class="content">
          <h1>How does this website work</h1>
          <span class="stats">;;&nbsp;3183w;&nbsp;16'</span>
          <h4><b>KEYWORDS:</b> development, web, devops</h4>
          <p>It's the obligatory &quot;how does this website work&quot; blog post!</p>
          <p>I'll try to keep this one on the less-refined side of things, but let's see. First off, I assume you already checked the <a href="/about/">about</a> page, which gives a very quick overview of why this place even exists in the first place.</p>
          <p>So I wanted to have a personal website. I've had the idea on my mind for a while, and mostly kept postponing it to avoid having to deal with the design-side of things. I've never been on the artistic side so the kind of things I can come up with on my own is quite limited, but after looking at some older software UIs for inspiration I decided to just get something out there, so I could move on to actually writing content.</p>
          <h2>html/css</h2>
          <p>I did the first design directly in HTML and CSS. And if HTML had some kind of native way of code reuse/includes, I might've been tempted to just stick to writing HTML for my content. But soon enough I found myself wanting to test more than a single page at a time, and that meant I had to create multiple HTML files, and at that point making a change meant having to make that same change across multiple files.</p>
          <p>A few decisions I made at this stage: 1/ No 3rd party resources, 2/ Don't do anything that would require a cookie banner, 3/ Avoid JS as much as possible, 4/ Don't bother with older browsers (yes, this includes IE11).</p>
          <h2>11ty</h2>
          <p>Since I wanted to keep things as simple as possible, a &quot;traditional&quot; n-tier stack was absolutely out of the question. The alternative was to use a static site generator. After reviewing the most popular choices, I settled for <a href="https://github.com/11ty/eleventy/" target="_blank" rel="noopener noreferrer">11ty</a> as it appeared to be the least opinionated one of the bunch, allowing me to start with an empty directory and slowly bring content and complexity in as needed. I followed my traditional approach of reading the entire docs to figure out what it can and cannot do before getting to adapting my static content to <a href="https://mozilla.github.io/nunjucks/" target="_blank" rel="noopener noreferrer">nunjucks</a>. I chose nunjucks simply because it was the default templating language used in the documentation.</p>
          <p>Lastly, I decided to manually number content items by adopting the following naming convention: <code>###-desired-content-url.ext</code>, and to manually provide content dates via Front Matter data, rather than use the mechanisms provided by 11ty based on either file system or Git dates.</p>
          <h3>Folder structure</h3>
<pre class="shiki rose-pine-dawn tree" style="background-color:#faf4ed;color:#575279"><code class="language-txt"><span class="line"><span>website/</span></span>
<span class="line"><span>├─ dist/</span></span>
<span class="line"><span>├─ src/</span></span>
<span class="line"><span>   ├─ _data/</span></span>
<span class="line"><span>   ├─ _includes/</span></span>
<span class="line"><span>   ├─ about/</span></span>
<span class="line"><span>   ├─ assets/</span></span>
<span class="line"><span>   │  ├─ fonts/</span></span>
<span class="line"><span>   │  ├─ icons/</span></span>
<span class="line"><span>   │  ├─ images/</span></span>
<span class="line"><span>   │  ├─ styles/</span></span>
<span class="line"><span>   ├─ photo/</span></span>
<span class="line"><span>   │  ├─ _drafts/</span></span>
<span class="line"><span>   ├─ recs/</span></span>
<span class="line"><span>   ├─ text/</span></span>
<span class="line"><span>      ├─ _drafts/</span></span></code></pre>
          <h3>Sass</h3>
          <p>I migrated all the styles from CSS to SCSS, since writing plain CSS is extremely repetitive. I'm using the <a href="https://github.com/kentaroi/eleventy-sass" target="_blank" rel="noopener noreferrer">eleventy-sass</a> plugin with no further configuration. Setting the <code>ELEVENTY_ENV</code> <a href="/text/002-environment-variables/">environment variable</a> to a non-production value will generate uncompressed CSS with source maps, which is nice.</p>
          <h3>Custom collections</h3>
          <p>My first challenge was implementing the &quot;group by month+year&quot; feature I had mocked up for the <a href="/text/">text</a> section. Lucky for us, 11ty lets you do a lot of pre-processing to prepare the right data structures you need in your templates using JavaScript, so I used <a href="https://lodash.com/" target="_blank" rel="noopener noreferrer">lodash</a> to do the grouping for me:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> _</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"lodash"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addCollection</span><span style="color:#575279">(</span><span style="color:#EA9D34">"textByMonth"</span><span style="color:#797593">,</span><span style="color:#797593"> (</span><span style="color:#907AA9;font-style:italic">collection</span><span style="color:#797593">)</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#D7827E;font-style:italic"> pad</span><span style="color:#286983"> =</span><span style="color:#907AA9;font-style:italic"> number</span><span style="color:#286983"> =></span><span style="color:#575279"> (</span><span style="color:#EA9D34">"00"</span><span style="color:#286983"> +</span><span style="color:#575279;font-style:italic"> number</span><span style="color:#286983">.</span><span style="color:#D7827E">toString</span><span style="color:#575279">())</span><span style="color:#286983">.</span><span style="color:#D7827E">slice</span><span style="color:#575279">(</span><span style="color:#286983">-</span><span style="color:#D7827E">2</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#575279;font-style:italic"> month</span><span style="color:#286983"> =</span><span style="color:#575279"> [</span><span style="color:#EA9D34">"JAN"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "FEB"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "MAR"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "APR"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "MAY"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "JUN"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "JUL"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "AUG"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "SEP"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "OCT"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "NOV"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "DEC"</span><span style="color:#575279">]</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">    return</span><span style="color:#575279;font-style:italic"> _</span><span style="color:#286983">.</span><span style="color:#D7827E">chain</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">collection</span><span style="color:#286983">.</span><span style="color:#D7827E">getFilteredByTag</span><span style="color:#575279">(</span><span style="color:#EA9D34">"text"</span><span style="color:#575279">)</span><span style="color:#286983">.</span><span style="color:#D7827E">reverse</span><span style="color:#575279">())</span></span>
<span class="line"><span style="color:#286983">      .</span><span style="color:#D7827E">groupBy</span><span style="color:#575279">(</span><span style="color:#907AA9;font-style:italic">text</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">        let</span><span style="color:#575279;font-style:italic"> date</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> text</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">date</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#EA9D34"> `</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">month</span><span style="color:#575279">[</span><span style="color:#575279;font-style:italic">date</span><span style="color:#286983">.</span><span style="color:#D7827E">getUTCMonth</span><span style="color:#575279">()]</span><span style="color:#797593">}${</span><span style="color:#D7827E">pad</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">date</span><span style="color:#286983">.</span><span style="color:#D7827E">getFullYear</span><span style="color:#575279">())</span><span style="color:#797593">}</span><span style="color:#EA9D34">`</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      }</span><span style="color:#575279">)</span></span>
<span class="line"><span style="color:#286983">      .</span><span style="color:#D7827E">toPairs</span><span style="color:#575279">()</span></span>
<span class="line"><span style="color:#286983">      .</span><span style="color:#D7827E">value</span><span style="color:#575279">()</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>This code is fragile: 1/ It depends on the collection being sorted by creation date in ascending order (before we reverse it). 2/ It depends on traversal order as specified by ECMAScript. But since I'm in full control of the environment where this code runs (either my laptop or the CD environment), I'm ok with this. The alternative would be to group by a key that is sortable, sort the resulting array by this key, then map this key back to a human-readable value. No reason to make things more complex than they need to be.</p>
          <h3>EXIF data</h3>
          <p>The next thing I wanted to do was automatically extract information like shutter speed, focal length, etc. from photos automatically from their <a href="https://en.wikipedia.org/wiki/Exif" target="_blank" rel="noopener noreferrer">EXIF data</a>. Lucky for me, 11ty's documentation on <a href="https://www.11ty.dev/docs/data-custom/" target="_blank" rel="noopener noreferrer">custom data file formats</a> describes this exact use-case. I picked a more up-to-date EXIF library, and used lodash again to help me get the data I needed. I also had to do some tweaking along the way to get things just right for me. Here's the final result:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> ExifReader</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"exifreader"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> _</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"lodash"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addDataExtension</span><span style="color:#575279">(</span><span style="color:#EA9D34">"jpg"</span><span style="color:#797593">,</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#D7827E">    parser</span><span style="color:#797593">:</span><span style="color:#286983"> async</span><span style="color:#907AA9;font-style:italic"> file</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">      const</span><span style="color:#D7827E;font-style:italic"> exifDate</span><span style="color:#286983"> =</span><span style="color:#907AA9;font-style:italic"> value</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#797593"> [</span><span style="color:#575279;font-style:italic"> date</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> time</span><span style="color:#797593"> ]</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#286983">.</span><span style="color:#D7827E">split</span><span style="color:#575279">(</span><span style="color:#EA9D34">' '</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#286983"> new</span><span style="color:#D7827E"> Date</span><span style="color:#575279">(</span><span style="color:#EA9D34">`</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">date</span><span style="color:#286983">.</span><span style="color:#D7827E">replaceAll</span><span style="color:#575279">(</span><span style="color:#EA9D34">':'</span><span style="color:#797593">,</span><span style="color:#EA9D34"> '-'</span><span style="color:#575279">)</span><span style="color:#797593">}</span><span style="color:#EA9D34">T</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">time</span><span style="color:#797593">}</span><span style="color:#EA9D34">.000Z`</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      };</span></span>
<span class="line"><span style="color:#286983">      const</span><span style="color:#575279;font-style:italic"> tags</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#575279;font-style:italic"> ExifReader</span><span style="color:#286983">.</span><span style="color:#D7827E">load</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">file</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">      const</span><span style="color:#575279;font-style:italic"> config</span><span style="color:#286983"> =</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#EA9D34">        "height"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "Image Height.value"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "width"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "Image Width.value"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "make"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "Make.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "model"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "Model.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "exposure"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "ExposureTime.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "aperture"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "FNumber.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "iso"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "ISOSpeedRatings.value"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "focalLength"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "FocalLength.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "lens"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "Lens.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "date"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "DateTime.description"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#EA9D34">        "originalDate"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "DateTimeOriginal.description"</span></span>
<span class="line"><span style="color:#797593">      };</span></span>
<span class="line"><span style="color:#286983">      const</span><span style="color:#575279;font-style:italic"> altModels</span><span style="color:#286983"> =</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#EA9D34">        "EOS DIGITAL REBEL XSi"</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "450D"</span></span>
<span class="line"><span style="color:#797593">      };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">      let</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> _</span><span style="color:#286983">.</span><span style="color:#D7827E">mapValues</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">config</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> tag</span><span style="color:#286983"> =></span><span style="color:#575279;font-style:italic"> _</span><span style="color:#286983">.</span><span style="color:#D7827E">get</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">tags</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> tag</span><span style="color:#575279">))</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#797593;font-style:italic">      //</span><span style="color:#9893A5;font-style:italic"> Canon repeats the Make in the Model</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983"> &#x26;&#x26;</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">make</span><span style="color:#286983"> &#x26;&#x26;</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983">.</span><span style="color:#D7827E">startsWith</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">make</span><span style="color:#575279">))</span></span>
<span class="line"><span style="color:#575279;font-style:italic">        exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983">.</span><span style="color:#D7827E">slice</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">make</span><span style="color:#286983">.</span><span style="color:#56949F">length</span><span style="color:#286983"> +</span><span style="color:#D7827E"> 1</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#797593;font-style:italic">      //</span><span style="color:#9893A5;font-style:italic"> Use alternative Models</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983"> &#x26;&#x26;</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983"> in</span><span style="color:#575279;font-style:italic"> altModels</span><span style="color:#575279">)</span></span>
<span class="line"><span style="color:#575279;font-style:italic">        exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> altModels</span><span style="color:#575279">[</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">model</span><span style="color:#575279">]</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#797593;font-style:italic">      //</span><span style="color:#9893A5;font-style:italic"> Remove trailing `f/` to get fstop value</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">aperture</span><span style="color:#575279">)</span></span>
<span class="line"><span style="color:#575279;font-style:italic">        exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">fstop</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">aperture</span><span style="color:#286983">.</span><span style="color:#D7827E">slice</span><span style="color:#575279">(</span><span style="color:#EA9D34">"f/"</span><span style="color:#286983">.</span><span style="color:#56949F">length</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">      else</span></span>
<span class="line"><span style="color:#575279;font-style:italic">        exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">fstop</span><span style="color:#286983"> =</span><span style="color:#D7827E"> undefined</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#797593;font-style:italic">      //</span><span style="color:#9893A5;font-style:italic"> Parse exif dates</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">date</span><span style="color:#575279">) </span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">date</span><span style="color:#286983"> =</span><span style="color:#D7827E"> exifDate</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">date</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">originalDate</span><span style="color:#575279">) </span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">originalDate</span><span style="color:#286983"> =</span><span style="color:#D7827E"> exifDate</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">exif</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">originalDate</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">      return</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> exif</span><span style="color:#797593"> };</span></span>
<span class="line"><span style="color:#797593">    },</span></span>
<span class="line"><span style="color:#797593;font-style:italic">    //</span><span style="color:#9893A5;font-style:italic"> Pass file path to `parser` rather than file contents</span></span>
<span class="line"><span style="color:#575279">    read</span><span style="color:#797593">:</span><span style="color:#D7827E"> false</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>Yes, all my input images are <code>*.jpg</code>. I'll update this if that ever changes.</p>
          <h3>Responsive images</h3>
          <p>Keeping on the photos (and images in general), I also wanted to automatically convert all my images to <a href="https://en.wikipedia.org/wiki/WebP" target="_blank" rel="noopener noreferrer">WebP</a> and provide images of different sizes to optimize bandwidth use for my visitors. Again, 11ty has you covered out of the box with the <a href="https://www.11ty.dev/docs/plugins/image/" target="_blank" rel="noopener noreferrer">Image plugin</a>. However, this plugin appears designed to be used for embedding static content, so I had to adapt it to do the processing as part of the custom data pipeline, and provide my own shortcode:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> path</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"node:path"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> Image</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"@11ty/eleventy-img"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addDataExtension</span><span style="color:#575279">(</span><span style="color:#EA9D34">"jpg"</span><span style="color:#797593">,</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#D7827E">    parser</span><span style="color:#797593">:</span><span style="color:#286983"> async</span><span style="color:#907AA9;font-style:italic"> file</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#797593;font-style:italic">      //</span><span style="color:#9893A5;font-style:italic"> Generate mobile-optimized images for the photos</span></span>
<span class="line"><span style="color:#286983">      let</span><span style="color:#575279;font-style:italic"> responsive</span><span style="color:#286983"> =</span><span style="color:#D7827E"> undefined</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279">      </span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">file</span><span style="color:#286983">.</span><span style="color:#D7827E">startsWith</span><span style="color:#575279">(</span><span style="color:#EA9D34">"./src/photo/"</span><span style="color:#575279">)) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#575279;font-style:italic"> stats</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#D7827E"> Image</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">file</span><span style="color:#797593">,</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#797593;font-style:italic">          //</span><span style="color:#9893A5;font-style:italic"> widths generated by</span></span>
<span class="line"><span style="color:#797593;font-style:italic">          //</span><span style="color:#9893A5;font-style:italic"> https://github.com/peter-neumann-dev/responsive-image-linter</span></span>
<span class="line"><span style="color:#575279">          widths</span><span style="color:#797593">:</span><span style="color:#575279"> [</span><span style="color:#EA9D34">"256"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "880"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "1220"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "1490"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "1710"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "1905"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "2048"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "auto"</span><span style="color:#575279">]</span><span style="color:#797593">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#575279">          formats</span><span style="color:#797593">:</span><span style="color:#575279"> [</span><span style="color:#EA9D34">"webp"</span><span style="color:#575279">]</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279">          urlPath</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "/assets/photo/"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279">          outputDir</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "./dist/assets/photo/"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#D7827E">          filenameFormat</span><span style="color:#797593">:</span><span style="color:#797593"> (</span><span style="color:#907AA9;font-style:italic">id</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> src</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> width</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> format</span><span style="color:#797593">)</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">            const</span><span style="color:#575279;font-style:italic"> extension</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> path</span><span style="color:#286983">.</span><span style="color:#D7827E">extname</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">src</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">            const</span><span style="color:#575279;font-style:italic"> name</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> path</span><span style="color:#286983">.</span><span style="color:#D7827E">basename</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">src</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> extension</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279">        </span></span>
<span class="line"><span style="color:#286983">            return</span><span style="color:#EA9D34"> `</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">name</span><span style="color:#797593">}</span><span style="color:#EA9D34">-</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">width</span><span style="color:#797593">}</span><span style="color:#EA9D34">w.</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">format</span><span style="color:#797593">}</span><span style="color:#EA9D34">`</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">          }</span></span>
<span class="line"><span style="color:#797593">        }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#575279;font-style:italic">        responsive</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> stats</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">webp</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">      return</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> responsive</span><span style="color:#797593"> };</span></span>
<span class="line"><span style="color:#797593">    },</span></span>
<span class="line"><span style="color:#797593;font-style:italic">    //</span><span style="color:#9893A5;font-style:italic"> Pass file path to `parser` rather than file contents</span></span>
<span class="line"><span style="color:#575279">    read</span><span style="color:#797593">:</span><span style="color:#D7827E"> false</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addShortcode</span><span style="color:#575279">(</span><span style="color:#EA9D34">"image"</span><span style="color:#797593">,</span><span style="color:#797593"> (</span><span style="color:#907AA9;font-style:italic">responsive</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> alt</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> sizes</span><span style="color:#797593">)</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#575279;font-style:italic"> largest</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> responsive</span><span style="color:#575279">[</span><span style="color:#575279;font-style:italic">responsive</span><span style="color:#286983">.</span><span style="color:#56949F">length</span><span style="color:#286983"> -</span><span style="color:#D7827E"> 1</span><span style="color:#575279">]</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#575279;font-style:italic"> srcset</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> responsive</span><span style="color:#286983">.</span><span style="color:#D7827E">map</span><span style="color:#575279">(</span><span style="color:#907AA9;font-style:italic">size</span><span style="color:#286983"> =></span><span style="color:#575279;font-style:italic"> size</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">srcset</span><span style="color:#575279">)</span><span style="color:#286983">.</span><span style="color:#D7827E">join</span><span style="color:#575279">(</span><span style="color:#EA9D34">", "</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">    return</span><span style="color:#EA9D34"> `&#x3C;img src="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">largest</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">url</span><span style="color:#797593">}</span><span style="color:#EA9D34">" srcset="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">srcset</span><span style="color:#797593">}</span><span style="color:#EA9D34">" sizes="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">sizes</span><span style="color:#797593">}</span><span style="color:#EA9D34">" width="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">largest</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">width</span><span style="color:#797593">}</span><span style="color:#EA9D34">" height="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">largest</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">height</span><span style="color:#797593">}</span><span style="color:#EA9D34">" alt="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">alt</span><span style="color:#797593">}</span><span style="color:#EA9D34">" loading="lazy" decoding="async">`</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>A few more things to call-out: I'm using my own paths here, and I also chose to do away with the &quot;unique identifiers&quot; the plugin generates by default, in favor of predictable filenames instead. I'd also like to add a huge shout-out to the <a href="https://github.com/peter-neumann-dev/responsive-image-linter" target="_blank" rel="noopener noreferrer">Responsive Image Linter</a> Chrome extension, which automatically resizes your webpage and provides a recommendation for both image resolutions and <code>&lt;img sizes=&quot;...&quot; /&gt;</code> configuration.</p>
          <p>In my actual code both of these snippets are merged into a single processing pipeline. I've split them here in for convenience in case anyone wants only one part of the functionality.</p>
          <h3>Better external links</h3>
          <p>I wanted to automatically make external links open in a new window by having <code>target=_blank</code> added to them. And while at it, I also wanted to add <code>rel=&quot;noopener noreferrer&quot;</code>. I built this as a filter using regular expressions for the parsing. I know, I know, HTML is not a regular language. But I don't need to parse HTML. I just need to find opening <code>&lt;a&gt;</code> tags, on HTML that ultimately I control, so this does the job perfectly well.</p>
          <p>I don't try to do anything smarter than that. If the attributes are not set, they will be set. If they are set, they will be left alone.</p>
          <p>This snippet needs to know where the website is hosted, so we get that information from the <code>homepage</code> field in the <code>package.json</code> file. Cute, right?</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> pkg</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"./package.json"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#575279;font-style:italic"> linkStartTag</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /&#x3C;a href="</span><span style="color:#797593">([</span><span style="color:#286983">^"</span><span style="color:#797593">]</span><span style="color:#286983">*</span><span style="color:#797593">)</span><span style="color:#EA9D34">"</span><span style="color:#797593">([</span><span style="color:#286983">^></span><span style="color:#797593">]</span><span style="color:#286983">*</span><span style="color:#797593">)</span><span style="color:#EA9D34">>/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#575279;font-style:italic"> targetAttr</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /target=/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#575279;font-style:italic"> relAttr</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /rel=/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> origin</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#286983"> new</span><span style="color:#D7827E"> URL</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">pkg</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">homepage</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addFilter</span><span style="color:#575279">(</span><span style="color:#EA9D34">"safeLinks"</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> value</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">    return</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#286983">.</span><span style="color:#D7827E">replaceAll</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">linkStartTag</span><span style="color:#797593">,</span><span style="color:#797593"> (</span><span style="color:#907AA9;font-style:italic">oldValue</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> linkUrl</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> attrs</span><span style="color:#797593">)</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">      let</span><span style="color:#575279;font-style:italic"> url</span><span style="color:#286983"> =</span><span style="color:#286983"> new</span><span style="color:#D7827E"> URL</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">linkUrl</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> origin</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279">      </span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">url</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">origin</span><span style="color:#286983"> !==</span><span style="color:#575279;font-style:italic"> origin</span><span style="color:#575279">)</span></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#EA9D34"> `&#x3C;a href="</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">linkUrl</span><span style="color:#797593">}</span><span style="color:#EA9D34">"</span><span style="color:#797593">${</span><span style="color:#286983">!</span><span style="color:#575279;font-style:italic">targetAttr</span><span style="color:#286983">.</span><span style="color:#D7827E">test</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">attrs</span><span style="color:#575279">)</span><span style="color:#286983"> ?</span><span style="color:#EA9D34"> ` target="_blank"`</span><span style="color:#286983"> :</span><span style="color:#EA9D34"> ""</span><span style="color:#797593">}${</span><span style="color:#286983">!</span><span style="color:#575279;font-style:italic">relAttr</span><span style="color:#286983">.</span><span style="color:#D7827E">test</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">attrs</span><span style="color:#575279">)</span><span style="color:#286983"> ?</span><span style="color:#EA9D34"> ` rel="noopener noreferrer"`</span><span style="color:#286983"> :</span><span style="color:#EA9D34"> ""</span><span style="color:#797593">}${</span><span style="color:#575279;font-style:italic">attrs</span><span style="color:#797593">}</span><span style="color:#EA9D34">>`</span></span>
<span class="line"><span style="color:#286983">      else</span></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#575279;font-style:italic"> oldValue</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">    }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <h3>Drafts</h3>
          <p>Somewhere in the 11ty docs they suggest using a <code>_drafts</code> folder, and I liked the idea. At the same time, I wanted to be able to test my drafts, so I configured 11ty to only ignore drafts in production, using the same logic as the that eleventy-sass plugin uses (I just copied their code here).</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#797593;font-style:italic">  //</span><span style="color:#9893A5;font-style:italic"> Environment-sensitive configuration</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> ELEVENTY_ENV</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> process</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">env</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279">  </span></span>
<span class="line"><span style="color:#797593;font-style:italic">  //</span><span style="color:#9893A5;font-style:italic"> Use same logic as `eleventy-sass` for now</span></span>
<span class="line"><span style="color:#286983">  if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">ELEVENTY_ENV</span><span style="color:#286983"> ===</span><span style="color:#D7827E"> undefined</span><span style="color:#286983"> ||</span><span style="color:#EA9D34"> "production"</span><span style="color:#286983">.</span><span style="color:#D7827E">startsWith</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">ELEVENTY_ENV</span><span style="color:#575279">)) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#797593;font-style:italic">    //</span><span style="color:#9893A5;font-style:italic"> Ignore `_drafts`</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    eleventyConfig</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">ignores</span><span style="color:#286983">.</span><span style="color:#D7827E">add</span><span style="color:#575279">(</span><span style="color:#EA9D34">"**/_drafts/**"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>I've created folders for the different content categories in my site (text, photo, etc.), and I have a <code>_drafts</code> folder inside each of these folders. Since I'm already using folder data files for each of my content categories, I enhanced the computed data to automatically remove <code>_drafts</code> from the generated content path, so that I can fully test draft content with the same URLs as I would have in production.</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279">  eleventyComputed</span><span style="color:#797593">:</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#D7827E">    permalink</span><span style="color:#797593">:</span><span style="color:#907AA9;font-style:italic"> data</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">data</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">filePathStem</span><span style="color:#286983">.</span><span style="color:#D7827E">includes</span><span style="color:#575279">(</span><span style="color:#EA9D34">"/_drafts/"</span><span style="color:#575279">)) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#EA9D34"> `</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">data</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">filePathStem</span><span style="color:#286983">.</span><span style="color:#D7827E">replace</span><span style="color:#575279">(</span><span style="color:#EA9D34">"/_drafts/"</span><span style="color:#797593">,</span><span style="color:#EA9D34"> "/"</span><span style="color:#575279">)</span><span style="color:#797593">}</span><span style="color:#EA9D34">/`</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      }</span></span>
<span class="line"><span style="color:#797593">    }</span></span>
<span class="line"><span style="color:#797593">  }</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <h3>Feature flags</h3>
          <p>Actually, I left a couple of lines out of that &quot;Environment-sensitive configuration&quot; snippet. Here's how it really looks like:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#797593;font-style:italic">  //</span><span style="color:#9893A5;font-style:italic"> Environment-sensitive configuration</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> ELEVENTY_ENV</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> process</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">env</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279">  </span></span>
<span class="line"><span style="color:#797593;font-style:italic">  //</span><span style="color:#9893A5;font-style:italic"> Use same logic as `eleventy-sass` for now</span></span>
<span class="line"><span style="color:#286983">  if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">ELEVENTY_ENV</span><span style="color:#286983"> ===</span><span style="color:#D7827E"> undefined</span><span style="color:#286983"> ||</span><span style="color:#EA9D34"> "production"</span><span style="color:#286983">.</span><span style="color:#D7827E">startsWith</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">ELEVENTY_ENV</span><span style="color:#575279">)) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#797593;font-style:italic">    //</span><span style="color:#9893A5;font-style:italic"> Ignore `_drafts`</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    eleventyConfig</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">ignores</span><span style="color:#286983">.</span><span style="color:#D7827E">add</span><span style="color:#575279">(</span><span style="color:#EA9D34">"**/_drafts/**"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#286983"> else</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#797593;font-style:italic">    //</span><span style="color:#9893A5;font-style:italic"> Feature-flag for experimental features</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addGlobalData</span><span style="color:#575279">(</span><span style="color:#EA9D34">"experimental"</span><span style="color:#797593">,</span><span style="color:#D7827E"> true</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>I'm using this opportunity to conditionally set feature flags (at the moment just one, the <code>experimental</code> flag). Just like <code>_drafts</code> lets me work on content without publishing it, the <code>experimental</code> flag lets me work on entire features without publishing them:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-handlebars"><span class="line"><span style="color:#575279">{%- if experimental %}</span></span>
<span class="line"><span style="color:#9893A5">&#x3C;</span><span style="color:#56949F">h1</span><span style="color:#9893A5">></span><span style="color:#575279">my next amazing feature</span><span style="color:#9893A5">&#x3C;/</span><span style="color:#56949F">h1</span><span style="color:#9893A5">></span></span>
<span class="line"><span style="color:#575279">{%- endif %}</span></span></code></pre>
          <p>This way I can be in the middle of working on a new feature, and still be able to publish a hotfix to production without having to create a new branch or stash my work in progress.</p>
          <h3>Syntax Highlighting</h3>
          <p>As I was writing this, I needed to add some syntax highlighting support for the code samples. I tried the <a href="https://www.11ty.dev/docs/plugins/syntaxhighlight/" target="_blank" rel="noopener noreferrer">official plugin</a> which uses <a href="https://prismjs.com/" target="_blank" rel="noopener noreferrer">PrismJS</a>. It worked, but it needed its CSS to be loaded externally. PrismJS itself felt clunky and outdated, and I could not find a theme I liked, so I started looking for alternatives.</p>
          <p>Luckily for me, things in 11ty are relatively straightforward. Markdown itself is processed by <a href="https://github.com/markdown-it/markdown-it" target="_blank" rel="noopener noreferrer">markdown-it</a>, and this component can be <a href="https://www.11ty.dev/docs/languages/markdown/" target="_blank" rel="noopener noreferrer">easily enhanced and/or reconfigured</a> if needed.</p>
          <p>With that in mind, I settled for <a href="https://shiki.style/" target="_blank" rel="noopener noreferrer">Shiki</a> as a better alternative. This highlighter comes with its own <a href="https://shiki.style/packages/markdown-it" target="_blank" rel="noopener noreferrer">markdown-it plugin</a>, and has a <a href="https://shiki.style/guide/transformers" target="_blank" rel="noopener noreferrer">nice API</a> for further enhancing the generated output.</p>
          <p>There are a couple of things to consider though: I've been working with CommonJS modules thus far, because I'm an old fart, but Shiki ship as an ECMAScript module only. That means using the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import" target="_blank" rel="noopener noreferrer">dynamic import</a> syntax, which loads the module asynchronously and returns a <code>Promise</code> that resolves to the module. This is not a problem, except 11ty does not support async functions as arguments for <code>eleventyConfig.amendLibrary</code>. The <a href="https://github.com/11ty/eleventy-plugin-syntaxhighlight/issues/32#issuecomment-1410641845" target="_blank" rel="noopener noreferrer">current workaround</a>, until 11ty V3 releases with support for async configuration functions, is to use the <code>eleventy.before</code> event, as event handlers can be async.</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> _Shiki</span><span style="color:#286983"> =</span><span style="color:#286983"> import</span><span style="color:#575279">(</span><span style="color:#EA9D34">"@shikijs/markdown-it"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#797593;font-style:italic">  //</span><span style="color:#9893A5;font-style:italic"> Workaround until amendLibrary supports async functions</span></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">on</span><span style="color:#575279">(</span><span style="color:#EA9D34">"eleventy.before"</span><span style="color:#797593">,</span><span style="color:#286983"> async</span><span style="color:#797593"> ()</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#797593"> {</span><span style="color:#D7827E;font-style:italic"> default</span><span style="color:#797593">:</span><span style="color:#575279;font-style:italic"> Shiki</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#575279;font-style:italic"> _Shiki</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#575279;font-style:italic"> metaUnquoted</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /</span><span style="color:#797593">([</span><span style="color:#286983">\w\-_</span><span style="color:#797593">]</span><span style="color:#286983">+</span><span style="color:#797593">)</span><span style="color:#EA9D34">=</span><span style="color:#797593">(?!</span><span style="color:#EA9D34">"</span><span style="color:#797593">)([</span><span style="color:#286983">^\s</span><span style="color:#797593">]</span><span style="color:#286983">*</span><span style="color:#797593">)</span><span style="color:#EA9D34">/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#575279;font-style:italic"> metaQuoted</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /</span><span style="color:#797593">([</span><span style="color:#286983">\w\-_</span><span style="color:#797593">]</span><span style="color:#286983">+</span><span style="color:#797593">)</span><span style="color:#EA9D34">="</span><span style="color:#797593">([</span><span style="color:#286983">^"</span><span style="color:#797593">]</span><span style="color:#286983">*</span><span style="color:#797593">)</span><span style="color:#EA9D34">"/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#575279;font-style:italic"> syntaxHighlighter</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#D7827E"> Shiki</span><span style="color:#575279">(</span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#575279">      theme</span><span style="color:#797593">:</span><span style="color:#EA9D34"> "rose-pine-dawn"</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279">      transformers</span><span style="color:#797593">:</span><span style="color:#575279"> [</span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#D7827E">        pre</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">node</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">          let</span><span style="color:#575279;font-style:italic"> rawMeta</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> this</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">options</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">meta</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">__raw</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">          if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">rawMeta</span><span style="color:#286983">.</span><span style="color:#D7827E">startsWith</span><span style="color:#575279">(</span><span style="color:#EA9D34">"["</span><span style="color:#575279">) </span><span style="color:#286983">&#x26;&#x26;</span><span style="color:#575279;font-style:italic"> rawMeta</span><span style="color:#286983">.</span><span style="color:#D7827E">endsWith</span><span style="color:#575279">(</span><span style="color:#EA9D34">"]"</span><span style="color:#575279">))</span></span>
<span class="line"><span style="color:#575279;font-style:italic">            rawMeta</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> rawMeta</span><span style="color:#286983">.</span><span style="color:#D7827E">slice</span><span style="color:#575279">(</span><span style="color:#D7827E">1</span><span style="color:#797593">,</span><span style="color:#286983"> -</span><span style="color:#D7827E">1</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">          const</span><span style="color:#575279;font-style:italic"> matches</span><span style="color:#286983"> =</span><span style="color:#575279"> [</span></span>
<span class="line"><span style="color:#286983">            ...</span><span style="color:#575279;font-style:italic">rawMeta</span><span style="color:#286983">.</span><span style="color:#D7827E">matchAll</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">metaUnquoted</span><span style="color:#575279">)</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#286983">            ...</span><span style="color:#575279;font-style:italic">rawMeta</span><span style="color:#286983">.</span><span style="color:#D7827E">matchAll</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">metaQuoted</span><span style="color:#575279">)</span></span>
<span class="line"><span style="color:#575279">          ]</span><span style="color:#286983">.</span><span style="color:#D7827E">map</span><span style="color:#575279">(</span><span style="color:#797593">([</span><span style="color:#907AA9;font-style:italic">oldValue</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> key</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> value</span><span style="color:#797593">])</span><span style="color:#286983"> =></span><span style="color:#575279"> [</span><span style="color:#575279;font-style:italic">key</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#575279">])</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">          for</span><span style="color:#575279"> (</span><span style="color:#286983">let</span><span style="color:#797593"> [</span><span style="color:#575279;font-style:italic">key</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#797593">]</span><span style="color:#286983"> of</span><span style="color:#575279;font-style:italic"> matches</span><span style="color:#575279">) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#286983">            if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">key</span><span style="color:#286983"> ===</span><span style="color:#EA9D34"> "class"</span><span style="color:#575279">) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#575279;font-style:italic">              this</span><span style="color:#286983">.</span><span style="color:#D7827E">addClassToHast</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">node</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">            }</span><span style="color:#286983"> else</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">              if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">key</span><span style="color:#286983">.</span><span style="color:#D7827E">startsWith</span><span style="color:#575279">(</span><span style="color:#EA9D34">"data-"</span><span style="color:#575279">)) </span><span style="color:#575279;font-style:italic">key</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> key</span><span style="color:#286983">.</span><span style="color:#D7827E">slice</span><span style="color:#575279">(</span><span style="color:#EA9D34">"data-"</span><span style="color:#286983">.</span><span style="color:#56949F">length</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279;font-style:italic">              node</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">properties</span><span style="color:#575279">[</span><span style="color:#EA9D34">`data-</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">key</span><span style="color:#797593">}</span><span style="color:#EA9D34">`</span><span style="color:#575279">] </span><span style="color:#286983">=</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">            }</span></span>
<span class="line"><span style="color:#797593">          }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">          delete</span><span style="color:#575279;font-style:italic"> node</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">properties</span><span style="color:#575279">[</span><span style="color:#EA9D34">"tabindex"</span><span style="color:#575279">]</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">        }</span></span>
<span class="line"><span style="color:#797593">      }</span><span style="color:#575279">]</span></span>
<span class="line"><span style="color:#797593">    }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">amendLibrary</span><span style="color:#575279">(</span><span style="color:#EA9D34">"md"</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> mdLib</span><span style="color:#286983"> =></span><span style="color:#575279;font-style:italic"> mdLib</span><span style="color:#286983">.</span><span style="color:#D7827E">use</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">syntaxHighlighter</span><span style="color:#575279">))</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>I took the liberty of providing a basic transformer that removes the <code>tabindex</code> property from the <code>&lt;pre&gt;</code> tag (Is there a reason to want to make these available to tab navigation that I'm not getting?), as well as allowing additional classes and attributes to be defined by adding them next to the code block fence, like so:</p>
<pre class="shiki rose-pine-dawn line-numbers diff" style="background-color:#faf4ed;color:#575279" data-start-line="53"><code class="language-md"><span class="line"><span style="color:#797593">```</span><span style="color:#575279">js [class="line-numbers diff" start-line=53]</span></span>
<span class="line"><span style="color:#797593;font-style:italic">//</span><span style="color:#9893A5;font-style:italic"> (... code here ...)</span></span>
<span class="line"><span style="color:#797593">```</span></span></code></pre>
          <p>You can inspect the source of this page and see this working for the code block above.</p>
          <h3>Better Indent</h3>
          <p>I've been using Nunjuck's <a href="https://mozilla.github.io/nunjucks/templating.html#indent" target="_blank" rel="noopener noreferrer">indent</a> filter to ensure that content included in layouts has the right indentation in the overall generated HTML. Sadly, I had to make an exception for code blocks, as <code>&lt;pre&gt;</code> render their content including whitespace.</p>
          <p>Anyway, I wrote my own indent filter that skips <code>&lt;pre&gt;</code> blocks:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> function</span><span style="color:#797593">(</span><span style="color:#907AA9;font-style:italic">eleventyConfig</span><span style="color:#797593">)</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#575279;font-style:italic"> preStartTag</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /&#x3C;pre</span><span style="color:#797593">([</span><span style="color:#286983">^></span><span style="color:#797593">]</span><span style="color:#286983">*</span><span style="color:#797593">)</span><span style="color:#EA9D34">>/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#575279;font-style:italic"> preEndTag</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> /&#x3C;</span><span style="color:#286983">\/</span><span style="color:#EA9D34">pre>/</span><span style="color:#286983">ig</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#575279;font-style:italic">  eleventyConfig</span><span style="color:#286983">.</span><span style="color:#D7827E">addFilter</span><span style="color:#575279">(</span><span style="color:#EA9D34">"betterIndent"</span><span style="color:#797593">,</span><span style="color:#797593"> (</span><span style="color:#907AA9;font-style:italic">value</span><span style="color:#797593">,</span><span style="color:#907AA9;font-style:italic"> spaces</span><span style="color:#797593">)</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">    const</span><span style="color:#797593"> [</span><span style="color:#575279;font-style:italic">first</span><span style="color:#797593">,</span><span style="color:#286983"> ...</span><span style="color:#575279;font-style:italic">rest</span><span style="color:#797593">]</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> value</span><span style="color:#286983">.</span><span style="color:#D7827E">split</span><span style="color:#575279">(</span><span style="color:#EA9D34">"</span><span style="color:#286983">\n</span><span style="color:#EA9D34">"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">    let</span><span style="color:#575279;font-style:italic"> newValue</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> first</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">    let</span><span style="color:#575279;font-style:italic"> insidePre</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> preStartTag</span><span style="color:#286983">.</span><span style="color:#D7827E">test</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">first</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">    for</span><span style="color:#575279"> (</span><span style="color:#286983">let</span><span style="color:#575279;font-style:italic"> line</span><span style="color:#286983"> of</span><span style="color:#575279;font-style:italic"> rest</span><span style="color:#575279">) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">preStartTag</span><span style="color:#286983">.</span><span style="color:#D7827E">test</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">line</span><span style="color:#575279">)) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#575279;font-style:italic">        insidePre</span><span style="color:#286983"> =</span><span style="color:#D7827E"> true</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      }</span><span style="color:#286983"> else</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">        if</span><span style="color:#575279"> (</span><span style="color:#286983">!</span><span style="color:#575279;font-style:italic">insidePre</span><span style="color:#575279">) </span><span style="color:#575279;font-style:italic">line</span><span style="color:#286983"> =</span><span style="color:#EA9D34"> `</span><span style="color:#797593">${</span><span style="color:#EA9D34">" "</span><span style="color:#286983">.</span><span style="color:#D7827E">repeat</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">spaces</span><span style="color:#575279">)</span><span style="color:#797593">}${</span><span style="color:#575279;font-style:italic">line</span><span style="color:#797593">}</span><span style="color:#EA9D34">`</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">        if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">preEndTag</span><span style="color:#286983">.</span><span style="color:#D7827E">test</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">line</span><span style="color:#575279">)) </span><span style="color:#575279;font-style:italic">insidePre</span><span style="color:#286983"> =</span><span style="color:#D7827E"> false</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#575279;font-style:italic">      newValue</span><span style="color:#286983"> +=</span><span style="color:#EA9D34"> `</span><span style="color:#286983">\n</span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">line</span><span style="color:#797593">}</span><span style="color:#EA9D34">`</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">    return</span><span style="color:#575279;font-style:italic"> newValue</span><span style="color:#286983">.</span><span style="color:#D7827E">trimEnd</span><span style="color:#575279">()</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">  }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <h3>Git</h3>
          <p>I thought it would be cool to show the currently deployed version by displaying information about the current commit. I'm just using <code>child_process</code> to call the Git CLI directly and providing what I need as a global data file:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> util</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">'node:util'</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> exec</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> util</span><span style="color:#286983">.</span><span style="color:#D7827E">promisify</span><span style="color:#575279">(</span><span style="color:#D7827E">require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"node:child_process"</span><span style="color:#575279">)</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">exec</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#286983"> async</span><span style="color:#797593"> ()</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> stdout</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#D7827E"> exec</span><span style="color:#575279">(</span><span style="color:#EA9D34">"git log -1 --format=%H%n%h%n%cI%n%s"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">  const</span><span style="color:#797593"> [</span><span style="color:#575279;font-style:italic">hash</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> shortHash</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> date</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> subject</span><span style="color:#797593">]</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> stdout</span><span style="color:#286983">.</span><span style="color:#D7827E">split</span><span style="color:#575279">(</span><span style="color:#EA9D34">"</span><span style="color:#286983">\n</span><span style="color:#EA9D34">"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#575279">  </span></span>
<span class="line"><span style="color:#286983">  return</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    hash</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    shortHash</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279">    date</span><span style="color:#797593">:</span><span style="color:#286983"> new</span><span style="color:#D7827E"> Date</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">date</span><span style="color:#575279">)</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279;font-style:italic">    subject</span></span>
<span class="line"><span style="color:#797593">  };</span></span>
<span class="line"><span style="color:#797593">};</span></span></code></pre>
          <p>Then I thought it would be even cooler to show a git-powered revision history, so I did it all over again as a folder data file:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> util</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">'node:util'</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> exec</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> util</span><span style="color:#286983">.</span><span style="color:#D7827E">promisify</span><span style="color:#575279">(</span><span style="color:#D7827E">require</span><span style="color:#575279">(</span><span style="color:#EA9D34">"node:child_process"</span><span style="color:#575279">)</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">exec</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#D7827E">    history</span><span style="color:#797593">:</span><span style="color:#286983"> async</span><span style="color:#907AA9;font-style:italic"> data</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">data</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">fileSlug</span><span style="color:#286983"> !==</span><span style="color:#EA9D34"> "text"</span><span style="color:#575279">) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> stdout</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#D7827E"> exec</span><span style="color:#575279">(</span><span style="color:#EA9D34">`git log --format=%H%n%h%n%cI%n%s%n </span><span style="color:#797593">${</span><span style="color:#575279;font-style:italic">data</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">inputPath</span><span style="color:#797593">}</span><span style="color:#EA9D34">`</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#575279;font-style:italic"> history</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> stdout</span><span style="color:#286983">.</span><span style="color:#D7827E">trimEnd</span><span style="color:#575279">()</span><span style="color:#286983">.</span><span style="color:#D7827E">split</span><span style="color:#575279">(</span><span style="color:#EA9D34">"</span><span style="color:#286983">\n\n</span><span style="color:#EA9D34">"</span><span style="color:#575279">)</span><span style="color:#286983">.</span><span style="color:#D7827E">map</span><span style="color:#575279">(</span><span style="color:#907AA9;font-style:italic">logEntry</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">          const</span><span style="color:#797593"> [</span><span style="color:#575279;font-style:italic">hash</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> shortHash</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> date</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> subject</span><span style="color:#797593">]</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> logEntry</span><span style="color:#286983">.</span><span style="color:#D7827E">split</span><span style="color:#575279">(</span><span style="color:#EA9D34">"</span><span style="color:#286983">\n</span><span style="color:#EA9D34">"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">          return</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279;font-style:italic">            hash</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279;font-style:italic">            shortHash</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279">            date</span><span style="color:#797593">:</span><span style="color:#286983"> new</span><span style="color:#D7827E"> Date</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">date</span><span style="color:#575279">)</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279;font-style:italic">            subject</span></span>
<span class="line"><span style="color:#797593">          };</span></span>
<span class="line"><span style="color:#797593">        }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#575279;font-style:italic"> history</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#797593">      }</span></span>
<span class="line"><span style="color:#797593">    }</span></span>
<span class="line"><span style="color:#797593">  }</span></span>
<span class="line"><span style="color:#575279">}</span><span style="color:#797593">;</span></span></code></pre>
          <h3>Reading time</h3>
          <p>I wanted to provide an indicator of length for the text content, so I used the <a href="https://github.com/ngryman/reading-time/" target="_blank" rel="noopener noreferrer">reading-time</a> library to add a word count and estimated reading time. I really wanted to get as precise a word count as possible, so I chose to re-load the Markdown and use that as the starting point (after skipping any Front Matter), rather than process the Markdown content already rendered into HTML and try to remove the tags:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-js"><span class="line"><span style="color:#286983">const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> readFile</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">'node:fs/promises'</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">const</span><span style="color:#575279;font-style:italic"> readingTime</span><span style="color:#286983"> =</span><span style="color:#D7827E"> require</span><span style="color:#575279">(</span><span style="color:#EA9D34">'reading-time'</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">module</span><span style="color:#286983">.</span><span style="color:#56949F">exports</span><span style="color:#286983"> =</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#D7827E">    stats</span><span style="color:#797593">:</span><span style="color:#286983"> async</span><span style="color:#907AA9;font-style:italic"> data</span><span style="color:#286983"> =></span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#286983">      if</span><span style="color:#575279"> (</span><span style="color:#575279;font-style:italic">data</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">fileSlug</span><span style="color:#286983"> !==</span><span style="color:#EA9D34"> "text"</span><span style="color:#575279">) </span><span style="color:#797593">{</span></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#575279;font-style:italic"> contents</span><span style="color:#286983"> =</span><span style="color:#286983"> await</span><span style="color:#D7827E"> readFile</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">data</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">page</span><span style="color:#286983">.</span><span style="color:#575279;font-style:italic">inputPath</span><span style="color:#797593">,</span><span style="color:#797593"> {</span><span style="color:#575279"> encoding</span><span style="color:#797593">:</span><span style="color:#EA9D34"> 'utf8'</span><span style="color:#797593"> }</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#575279;font-style:italic"> fragments</span><span style="color:#286983"> =</span><span style="color:#575279;font-style:italic"> contents</span><span style="color:#286983">.</span><span style="color:#D7827E">split</span><span style="color:#575279">(</span><span style="color:#EA9D34">"---</span><span style="color:#286983">\n</span><span style="color:#EA9D34">"</span><span style="color:#575279">)</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">        const</span><span style="color:#797593"> {</span><span style="color:#575279;font-style:italic"> words</span><span style="color:#797593">,</span><span style="color:#575279;font-style:italic"> minutes</span><span style="color:#797593"> }</span><span style="color:#286983"> =</span><span style="color:#D7827E"> readingTime</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">fragments</span><span style="color:#575279">[</span><span style="color:#575279;font-style:italic">fragments</span><span style="color:#286983">.</span><span style="color:#56949F">length</span><span style="color:#286983"> -</span><span style="color:#D7827E"> 1</span><span style="color:#575279">])</span><span style="color:#797593">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#286983">        return</span><span style="color:#797593"> {</span></span>
<span class="line"><span style="color:#575279;font-style:italic">          words</span><span style="color:#797593">,</span></span>
<span class="line"><span style="color:#575279">          minutes</span><span style="color:#797593">:</span><span style="color:#575279;font-style:italic"> Math</span><span style="color:#286983">.</span><span style="color:#D7827E">ceil</span><span style="color:#575279">(</span><span style="color:#575279;font-style:italic">minutes</span><span style="color:#575279">)</span></span>
<span class="line"><span style="color:#797593">        };</span></span>
<span class="line"><span style="color:#797593">      }</span></span>
<span class="line"><span style="color:#797593">    }</span></span>
<span class="line"><span style="color:#797593">  }</span></span>
<span class="line"><span style="color:#575279">}</span><span style="color:#797593">;</span></span></code></pre>
          <p>Ideally I would be able to configure <code>markdown-it</code> to perform plain-text rendering with some additional tweaking such as completely ignoring code blocks. I tried going through the documentation but could not find a suitable example to use as a starting point, I guess I'll need to look at some plugins or similar and see if I can figure it out. For the time-being this will have to do.</p>
          <h2>Continuous Deployment</h2>
          <p>The <code>build-and-deploy</code> workflow handles continuous deployment to GitHub Pages, with a twist: The repository that hosts the actual GitHub Pages is not this repository, it's <a href="https://github.com/causti-co/causti-co.github.io" target="_blank" rel="noopener noreferrer">causti-co/causti-co.github.io</a>. So the deploy step is actually just pushing the latest static content into this repository, using <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/managing-deploy-keys#deploy-keys" target="_blank" rel="noopener noreferrer">deploy keys</a>:</p>
<pre class="shiki rose-pine-dawn" style="background-color:#faf4ed;color:#575279"><code class="language-yaml"><span class="line"><span style="color:#56949F">name</span><span style="color:#797593">:</span><span style="color:#EA9D34"> build and deploy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56949F">jobs</span><span style="color:#797593">:</span></span>
<span class="line"><span style="color:#56949F">  deploy</span><span style="color:#797593">:</span></span>
<span class="line"><span style="color:#56949F">    runs-on</span><span style="color:#797593">:</span><span style="color:#EA9D34"> ubuntu-latest</span></span>
<span class="line"><span style="color:#56949F">    needs</span><span style="color:#797593">:</span><span style="color:#EA9D34"> build</span></span>
<span class="line"><span style="color:#56949F">    steps</span><span style="color:#797593">:</span></span>
<span class="line"><span style="color:#797593">    -</span><span style="color:#56949F"> uses</span><span style="color:#797593">:</span><span style="color:#EA9D34"> actions/checkout@v4</span></span>
<span class="line"><span style="color:#56949F">      with</span><span style="color:#797593">:</span></span>
<span class="line"><span style="color:#56949F">        repository</span><span style="color:#797593">:</span><span style="color:#EA9D34"> causti-co/causti-co.github.io</span></span>
<span class="line"><span style="color:#56949F">        ssh-key</span><span style="color:#797593">:</span><span style="color:#EA9D34"> '${{ secrets.DEPLOY_KEY }}'</span></span>
<span class="line"><span style="color:#797593">    -</span><span style="color:#56949F"> uses</span><span style="color:#797593">:</span><span style="color:#EA9D34"> actions/download-artifact@v4</span></span>
<span class="line"><span style="color:#56949F">      with</span><span style="color:#797593">:</span></span>
<span class="line"><span style="color:#56949F">        name</span><span style="color:#797593">:</span><span style="color:#EA9D34"> dist-bundle</span></span>
<span class="line"><span style="color:#797593">    -</span><span style="color:#56949F"> name</span><span style="color:#797593">:</span><span style="color:#EA9D34"> git config</span></span>
<span class="line"><span style="color:#56949F">      run</span><span style="color:#797593">:</span><span style="color:#286983"> |</span></span>
<span class="line"><span style="color:#EA9D34">        git config --global user.name "${{ github.event.head_commit.author.name }}"</span></span>
<span class="line"><span style="color:#EA9D34">        git config --global user.email "${{ github.event.head_commit.author.email }}"</span></span>
<span class="line"><span style="color:#797593">    -</span><span style="color:#56949F"> run</span><span style="color:#797593">:</span><span style="color:#EA9D34"> git add .</span></span>
<span class="line"><span style="color:#797593">    -</span><span style="color:#56949F"> run</span><span style="color:#797593">:</span><span style="color:#EA9D34"> git commit -am "${{ github.event.head_commit.message }}"</span></span>
<span class="line"><span style="color:#56949F">      continue-on-error</span><span style="color:#797593">:</span><span style="color:#D7827E"> true</span></span>
<span class="line"><span style="color:#797593">    -</span><span style="color:#56949F"> run</span><span style="color:#797593">:</span><span style="color:#EA9D34"> git push</span></span></code></pre>
          <p>We can use the event data provided by GitHub actions at <code>github.event.head_commit</code> to reuse the information from the latest commit of this repo when pushing to the deployment repository. Also, we want the <code>git commit</code> step to tolerate errors: This step will fail when the working tree is empty (e.g., when there's nothing to commit). This just means that whatever we changed had no effect on the generated content. This is not an error, and we do not want the workflow to fail and get paged.</p>
          <p>So, why am I deploying to a different repository just to use GitHub Pages over there and not here? Because I really did not want to use <code>docs/</code> for GitHub Pages, and the only way I'd be happy with the static content sitting at the root of a repository is by having a dedicated repository just for the static content.</p>
          <p>Overall I'm happy with this approach, and from the point of view of this repository, we're 100% agnostic of GitHub Pages which makes it easier for me to change hosting providers in the future.</p>
          <h2>What's next?</h2>
          <p>Well, I now have a personal website. The first priority will be to keep it fresh with content. I've a <a href="https://github.com/causti-co/website/blob/main/docs/ideas.md" target="_blank" rel="noopener noreferrer">backlog of content ideas</a> (and as a matter of fact, it was <a href="https://github.com/causti-co/website/tree/26b720d50f9fea29dfd2bb140d6dd8e55a6c7b6e" target="_blank" rel="noopener noreferrer">the first thing I did in this repository</a>, even before starting with the design), that I'll be working through, and thanks to the drafts I can decouple authoring from publishing.</p>
          <p>I'll try to keep to one text and one photo per week, and see how I feel with that rhythm.</p>
          <p>Meanwhile, I've also a <a href="https://github.com/causti-co/website/blob/main/docs/todo.md" target="_blank" rel="noopener noreferrer">backlog of website features</a> to work on whenever I get the urge to ship something before my next publishing date comes up. Let's see. So far, I've been having a blast. I hope you stay along for the ride.</p>
        </section>
      </article>
    </main>
    <footer>
      <div id="git">
        <a class="open" href="#git">
          <img src="/assets/images/git.svg" alt="Git"/>
          <img class="selected" src="/assets/images/git.alt.svg" alt="open git panel" width="97" height="97" />
        </a>
        <a class="close" href="#">
          <img class="selected" src="/assets/images/git.alt.svg" alt="close git panel" width="97" height="97"/>
        </a>
        <div class="content">
          <div class="actions">
            <a href="https://github.com/causti-co/website/blob/main//src/text/005-website-stack.md" target="_blank" rel="noopener noreferrer">≡</a>
            <a href="https://github.com/causti-co/website/edit/main//src/text/005-website-stack.md" target="_blank" rel="noopener noreferrer">±</a>
          </div>
          <table>
            <thead>
              <tr>
                <th>date</th>
                <th>subject</th>
                <th>commit</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>19.04.24</td>
                <td><b>fix(text): website stack description</b></td>
                <td><a href="https://github.com/causti-co/website/commit/5c8cf9f9de060119d863266b21bdf07b2fb1c1ca" target="_blank" rel="noopener noreferrer">5c8cf9f</a></td>
              </tr>
              <tr>
                <td>19.04.24</td>
                <td><b>feat(text): website stack</b></td>
                <td><a href="https://github.com/causti-co/website/commit/1c9b10929496715b0b2b2393890c092e3eaa2655" target="_blank" rel="noopener noreferrer">1c9b109</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <nav>
        <ul>
          <li><div class="button"><a href="/">home</a></div></li>
          <li><div class="button"><a href="/text/">text</a></div></li>
          <li><div class="button"><a href="/photo/">photo</a></div></li>
          <li><div class="button"><a href="/recs/">recs</a></div></li>
          <li><div class="button"><a href="/about/">about</a></div></li>
        </ul>
      </nav>
      <div class="content">
        <p class="cc" xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
          <a property="dct:title" rel="cc:attributionURL" href="https://causti.co/">causti • co</a> © 2024 by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://twitter.com/mvaldesdeleon">Martín Valdés de León</a>, is licensed under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-ND 4.0<img class="icon" src="/assets/images/cc/cc.svg" alt="CC" width="64" height="64" /><img class="icon" src="/assets/images/cc/by.svg" alt="BY" width="64" height="64" /><img class="icon" src="/assets/images/cc/nc.svg" alt="NC" width="64" height="64" /><img class="icon" src="/assets/images/cc/nd.svg" alt="ND" width="64" height="64" /></a>
        </p>
      </div>
    </footer>
  </body>
</html>